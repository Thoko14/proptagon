version: 1
applications:
  - appRoot: platform
    frontend:
      phases:
        preBuild:
          commands:
            # Install dependencies for all workspaces using the ROOT lockfile
            - cd .. && npm ci
        build:
          commands:
            # Build only the "platform" workspace (Vite project)
            - cd .. && npm run build --workspace=platform
      artifacts:
        # Deploy the built files from the workspace output
        baseDirectory: dist
        files:
          - '**/*'
      cache:
        paths:
          - ../node_modules/**/*
          - node_modules/**/*